<%- contentFor('body') %>
<div class="row">
        <% for(t of tables) { %>
            <div class="col s12 m6" >
                    <div class="card blue-grey darken-1">
                      <div class="card-content white-text">
                        <span class="card-title icon"><img src="images/icons/tableitem.svg" class="responsive-img "><h4><%- t.name %></h4></span>
                        <ul class="collapsible" id="<%- t.id %>">
                         
                        </ul>
                       
                      </div>
                      <div class="card-action">
                        <a href="#">This is a link</a>
                        <a href="#">This is a link</a>
                      </div>
                    </div>
                  </div>
            <% } %>
    
</div>

<script src="socket.io/socket.io.js"></script>
<script>
  let mydata=[];
  let addProducts=[];
 
  let idDashs= <%- JSON.stringify(tables) %>;



 
  console.log(idDashs)

    window.onload=()=>{
      const elems = document.querySelectorAll('.collapsible');
      //const myul=document.querySelectorAll('UL');
      const instances = M.Collapsible.init(elems, {acordion:true});
          
           
      
       const socket=io('https://192.168.1.108:3000');

        socket.on('outproduct',data=>{
            
        //  console.log(data);
            
            
            idDashs.forEach(dash => {
                const ul=document.getElementById(dash.id);
                const li=document.createElement('li');

                data.forEach(comanda=>{
                 
                 
                  
                 if(comanda.clients_id ===li.id && comanda.tables_id===ul.id  ){
                    console.log(`li - ${li.id}`)
                    li.innerHTML=` <div class="collapsible-header blue-grey darken-1"><i class="material-icons">filter_drama</i>${comanda.clients_name}</div>`
                    ul.appendChild(li);
                 }else{
                    li.id=comanda.clients_id;
                 }
                  
                 

                })
            });


          data.forEach(comanda=>{

            const li=document.getElementById(comanda.clients_id);
            let collapsibleBody=document.createElement('div');
                 collapsibleBody.classList.add('collapsible-body','blue-grey','darken-1');
                 collapsibleBody.dataset.id=comanda.clients_id;
                 collapsibleBody.id=comanda.id;
                 collapsibleBody.innerHTML=`<span>${comanda.product}</span><span>${comanda.price}</span>`

                 if(li.id===collapsibleBody.dataset.id){
                      li.appendChild(collapsibleBody)
                  }

          })
            
           addProducts.push(data);
         
         
      });


     

    // console.log(elems[0].id)


    }

</script>